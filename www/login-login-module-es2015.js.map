{"version":3,"sources":["./src/app/login/login.page.ts","./node_modules/jwt-decode/lib/index.js","./src/app/login/login.page.html","./src/app/login/login.module.ts","./node_modules/jwt-decode/lib/base64_url_decode.js","./node_modules/jwt-decode/lib/atob.js","./src/app/login/login.page.scss"],"names":[],"mappings":"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","file":"login-login-module-es2015.js","sourcesContent":["import {BehaviorSubject} from 'rxjs'\nimport {AuthService} from './../services/auth.service'\nimport {Component, OnInit, HostListener, ViewChild} from '@angular/core'\nimport {FormGroup, FormBuilder, Validators} from '@angular/forms'\nimport {Router} from '@angular/router'\nimport {SharedService} from '../services/shared.service'\nimport {IonInput, NavController, Platform} from '@ionic/angular'\nimport jwtDecode from 'jwt-decode'\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.page.html',\n  styleUrls: ['./login.page.scss'],\n})\nexport class LoginPage implements OnInit {\n  @ViewChild('emailInput') emailInput: IonInput\n  loginForm: FormGroup\n  isSubmitted = false\n  type = 'password'\n  showPass = false\n  userPlatform\n\n  @HostListener('document:keypress', ['$event'])\n  handleKeyboardEvent(event: KeyboardEvent) {\n    if (this.loginForm.valid && event.key === 'Enter') {\n      this.login()\n    }\n  }\n\n  constructor(\n    private formBuilder: FormBuilder,\n    private sharedService: SharedService,\n    public navController: NavController,\n    private authService: AuthService,\n    private router: Router,\n    public platform: Platform,\n  ) {\n    this.sharedService.gaTrackView('LoginScreen')\n\n    this.sharedService.getDeviceInfo().then((info) => {\n      this.userPlatform = `${info.manufacturer} ( ${info.platform} ) ${info.model} ( ${info.osVersion} ) - ${info.appVersion}`\n    })\n  }\n\n  ngOnInit() {\n    this.loginForm = this.formBuilder.group({\n      email: [\n        '',\n        Validators.compose([\n          Validators.required,\n          Validators.pattern(\n            '^[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:.[a-zA-Z0-9-]+)*$',\n          ),\n        ]),\n      ],\n      password: ['', Validators.required],\n    })\n  }\n\n  ionViewWillEnter() {\n    // setTimeout(() => this.emailInput.setFocus(), 300)\n  }\n\n  get f() {\n    return this.loginForm.controls\n  }\n\n  showPassword() {\n    this.showPass = !this.showPass\n\n    if (this.showPass) {\n      this.type = 'text'\n    } else {\n      this.type = 'password'\n    }\n  }\n\n  trimEmail(event) {\n    this.loginForm.patchValue({\n      email: event.target.value.trim(),\n    })\n  }\n  handleSubmit() {\n    setTimeout(() => {\n      this.login()\n    }, 300)\n  }\n\n  async login() {\n    this.isSubmitted = true\n\n    if (this.loginForm.invalid) {\n      return\n    }\n\n    this.sharedService.gaTrackEvent('SignInButton', 'SignInScreen')\n\n    this.sharedService.presentLoader('Please wait...')\n\n    const user = this.loginForm.value\n    user.email = this.loginForm.value.email.trim().toLowerCase()\n    user.loginType = 'Email'\n    user.userPlatform = this.userPlatform\n\n    try {\n      const res = await this.authService.login(user).toPromise()\n\n      if (res.token) {\n        const data = jwtDecode(res.token)\n        // console.log({data})\n        this.sharedService.setNativeStorage('isAdmin', !!data.isAdmin)\n        this.sharedService.setNativeStorage('isOnBoarding', true)\n        await this.sharedService.setNativeStorage('token', res.token)\n\n        this.authService.token$ = new BehaviorSubject(res.token)\n        this.authService.authSubject.next(true)\n        this.sharedService.presentToast('Login successfully.')\n        this.navController.setDirection('root')\n        this.router.navigate(['/dashboard'])\n      }\n    } catch (err) {\n      this.sharedService.presentAlert('Alert', err.error)\n    }\n    this.sharedService.dismissLoader()\n  }\n}\n","'use strict';\n\nvar base64_url_decode = require('./base64_url_decode');\n\nfunction InvalidTokenError(message) {\n  this.message = message;\n}\n\nInvalidTokenError.prototype = new Error();\nInvalidTokenError.prototype.name = 'InvalidTokenError';\n\nmodule.exports = function (token,options) {\n  if (typeof token !== 'string') {\n    throw new InvalidTokenError('Invalid token specified');\n  }\n\n  options = options || {};\n  var pos = options.header === true ? 0 : 1;\n  try {\n    return JSON.parse(base64_url_decode(token.split('.')[pos]));\n  } catch (e) {\n    throw new InvalidTokenError('Invalid token specified: ' + e.message);\n  }\n};\n\nmodule.exports.InvalidTokenError = InvalidTokenError;\n","export default \"<ion-content>\\n  <ion-grid class=\\\"ion-padding h-100\\\">\\n    <ion-row class=\\\"h-100 auth-form ion-align-items-center\\\">\\n      <ion-col class=\\\"ion-align-self-center\\\">\\n        <ion-row class=\\\"ion-justify-content-center\\\">\\n          <!-- <ion-col sizeXs=\\\"4\\\" sizeSm=\\\"4\\\" sizeLg=\\\"2\\\" sizeXl=\\\"1\\\" sizeMd=\\\"2\\\" class=\\\"ion-align-self-center ion-padding\\\">\\n            <img src=\\\"/assets/images/logo.png\\\">\\n          </ion-col> -->\\n          <ion-col size-xs=\\\"8\\\" size-sm=\\\"8\\\" size-lg=\\\"4\\\" size-md=\\\"4\\\" size-xl=\\\"2\\\" class=\\\"ion-align-self-center\\\">\\n            <img src=\\\"../../assets/images/Speaky-Peaky-Logo.png\\\" />\\n          </ion-col>\\n        </ion-row>\\n        <form [formGroup]=\\\"loginForm\\\" (ngSubmit)=\\\"login()\\\">\\n          <ion-row class=\\\"ion-justify-content-center\\\">\\n            <ion-col class=\\\"ion-align-self-center\\\" sizeXs=\\\"12\\\" sizeSm=\\\"12\\\" sizeLg=\\\"5\\\" sizeXl=\\\"4\\\" sizeMd=\\\"6\\\">\\n              <ion-row>\\n                <ion-col size=\\\"12\\\">\\n                  <ion-item mode=\\\"ios\\\" class=\\\"ion-no-padding auth-inputs\\\"\\n                    [class.invalid]=\\\"!f.email.valid && (f.email.dirty || isSubmitted)\\\">\\n                    <ion-label position=\\\"floating\\\">Email</ion-label>\\n                    <ion-input #emailInput autofocus='true' email (ionBlur)=\\\"trimEmail($event)\\\" formControlName=\\\"email\\\"\\n                      pattern=\\\"^\\\\w+([\\\\.-]?\\\\w+)*@\\\\w+([\\\\.-]?\\\\w+)*(\\\\.\\\\w{2,3})+$\\\" required>\\n                    </ion-input>\\n                  </ion-item>\\n                  <ion-text color=\\\"danger\\\" *ngIf=\\\"!f.email.valid && (f.email.dirty || isSubmitted)\\\">\\n                    <small>Please enter a valid email.</small>\\n                  </ion-text>\\n                </ion-col>\\n              </ion-row>\\n              <ion-row>\\n                <ion-col size=\\\"12\\\">\\n                  <ion-item mode=\\\"ios\\\" class=\\\"ion-no-padding auth-inputs\\\"\\n                    [class.invalid]=\\\"!f.password.valid && (f.password.dirty || isSubmitted)\\\">\\n                    <ion-label position=\\\"floating\\\">Password</ion-label>\\n                    <ion-input [type]=\\\"!showPass ? 'password' : 'text'\\\" formControlName=\\\"password\\\" required>\\n                    </ion-input>\\n                    <ion-icon class=\\\"pwd-btn\\\" *ngIf=\\\"showPass === false; else viewPassword\\\" slot=\\\"end\\\" name=\\\"eye-off\\\"\\n                      (click)=\\\"showPassword()\\\"></ion-icon>\\n                    <ng-template #viewPassword>\\n                      <ion-icon class=\\\"pwd-btn\\\" slot=\\\"end\\\" name=\\\"eye\\\" (click)=\\\"showPassword()\\\"></ion-icon>\\n                    </ng-template>\\n                  </ion-item>\\n                  <ion-text color=\\\"danger\\\" *ngIf=\\\"!f.password.valid && (f.password.dirty || isSubmitted)\\\">\\n                    <small>Please enter a password.</small>\\n                  </ion-text>\\n                  <p>\\n                    <a class=\\\"ion-text-right c-orange\\\" [routerLink]=\\\"['/forgot-password']\\\"\\n                      routerLinkActive=\\\"router-link-active\\\">Forgot Password?</a>\\n                  </p>\\n                </ion-col>\\n              </ion-row>\\n              <ion-row class=\\\"ion-margin-top\\\">\\n                <ion-col size=\\\"12\\\">\\n                  <ion-button mode=\\\"ios\\\" color=\\\"danger\\\" shape=\\\"round\\\" expand=\\\"block\\\" type=\\\"button\\\"\\n                    (click)=\\\"handleSubmit()\\\">\\n                    <strong>SIGN IN</strong>\\n                  </ion-button>\\n                </ion-col>\\n              </ion-row>\\n              <ion-row>\\n                <ion-col size=\\\"12\\\">\\n                  <p class=\\\"ion-text-center ion-no-margin\\\">\\n                    Don’t have an account?\\n                    <a class=\\\"c-orange\\\" [routerLink]=\\\"['/sign-up']\\\" routerLinkActive=\\\"router-link-active\\\">\\n                      Sign up\\n                    </a>\\n                    here.\\n                  </p>\\n                </ion-col>\\n              </ion-row>\\n            </ion-col>\\n          </ion-row>\\n        </form>\\n      </ion-col>\\n    </ion-row>\\n  </ion-grid>\\n</ion-content>\";","import {NgModule} from '@angular/core'\nimport {CommonModule} from '@angular/common'\nimport {FormsModule, ReactiveFormsModule} from '@angular/forms'\nimport {Routes, RouterModule} from '@angular/router'\n\nimport {IonicModule} from '@ionic/angular'\n\nimport {LoginPage} from './login.page'\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: LoginPage,\n  },\n]\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    RouterModule.forChild(routes),\n  ],\n  declarations: [LoginPage],\n  providers: [],\n})\nexport class LoginPageModule {}\n","var atob = require('./atob');\n\nfunction b64DecodeUnicode(str) {\n  return decodeURIComponent(atob(str).replace(/(.)/g, function (m, p) {\n    var code = p.charCodeAt(0).toString(16).toUpperCase();\n    if (code.length < 2) {\n      code = '0' + code;\n    }\n    return '%' + code;\n  }));\n}\n\nmodule.exports = function(str) {\n  var output = str.replace(/-/g, \"+\").replace(/_/g, \"/\");\n  switch (output.length % 4) {\n    case 0:\n      break;\n    case 2:\n      output += \"==\";\n      break;\n    case 3:\n      output += \"=\";\n      break;\n    default:\n      throw \"Illegal base64url string!\";\n  }\n\n  try{\n    return b64DecodeUnicode(output);\n  } catch (err) {\n    return atob(output);\n  }\n};\n","/**\n * The code was extracted from:\n * https://github.com/davidchambers/Base64.js\n */\n\nvar chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n\nfunction InvalidCharacterError(message) {\n  this.message = message;\n}\n\nInvalidCharacterError.prototype = new Error();\nInvalidCharacterError.prototype.name = 'InvalidCharacterError';\n\nfunction polyfill (input) {\n  var str = String(input).replace(/=+$/, '');\n  if (str.length % 4 == 1) {\n    throw new InvalidCharacterError(\"'atob' failed: The string to be decoded is not correctly encoded.\");\n  }\n  for (\n    // initialize result and counters\n    var bc = 0, bs, buffer, idx = 0, output = '';\n    // get next character\n    buffer = str.charAt(idx++);\n    // character found in table? initialize bit storage and add its ascii value;\n    ~buffer && (bs = bc % 4 ? bs * 64 + buffer : buffer,\n      // and if not first of each 4 characters,\n      // convert the first 8 bits to one ascii character\n      bc++ % 4) ? output += String.fromCharCode(255 & bs >> (-2 * bc & 6)) : 0\n  ) {\n    // try to find character in table (0-63, not found => -1)\n    buffer = chars.indexOf(buffer);\n  }\n  return output;\n}\n\n\nmodule.exports = typeof window !== 'undefined' && window.atob && window.atob.bind(window) || polyfill;\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJsb2dpbi5wYWdlLnNjc3MifQ== */\";"],"sourceRoot":"webpack:///"}